---
- name: Install controller prerequisites for Phase 1
  hosts: baremetal
  gather_facts: false
  become: true
  vars:
    install_terraform: true
    install_azure_cli: true
    install_virtualbox: true
  roles:
    - role: installprerequisites

  tasks:
    - name: Configure VirtualBox VM autostart (optional)
      ansible.builtin.include_role:
        name: vbox_vm_autostart
      when:
        - (groups['target_vms'] | default([]) | length) > 0
        - (hostvars[(groups['target_vms'] | first)].enable_vbox_vm_autostart | default(false)) | bool
