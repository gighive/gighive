[ req ]
default_bits       = 2048
default_md         = sha256
distinguished_name = req_distinguished_name
req_extensions     = v3_req
x509_extensions    = v3_req
prompt             = no

[ req_distinguished_name ]
CN = {{ gighive_cert_cn | default(gighive_server_name | default('gighive')) }}

[ v3_req ]
subjectAltName = @alt_names
keyUsage = critical, digitalSignature, keyEncipherment
extendedKeyUsage = serverAuth

[ alt_names ]
{% set sans = (gighive_cert_dns_sans
               | default([gighive_server_name | default('gighive'),
                          gighive_server_alias | default('gighive')])) %}
{% for san in sans %}
DNS.{{ loop.index }} = {{ san }}
{% endfor %}
