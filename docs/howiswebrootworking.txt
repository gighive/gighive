sodo@pop-os:~/scripts/gighive/ansible/roles/docker/files/apache$ cat Dockerfile 
FROM ubuntu:22.04

# Set environment variables
ARG PHP_VERSION=8.1
ENV WEB_ROOT="/var/www/html"
ENV SSL_CERT_DIR="/etc/ssl/certs"
ENV SSL_PRIVATE_DIR="/etc/ssl/private"
ENV DEBIAN_FRONTEND=noninteractive

..

ARG APP_FLAVOR=stormpigs

# 1) Copy only composer manifests, install deps (from canonical webroot)
COPY webroot/composer.json webroot/composer.lock ${WEB_ROOT}/
# Set working directory to web root
WORKDIR ${WEB_ROOT}
RUN composer install \
    --no-dev --optimize-autoloader --classmap-authoritative

# 2) Copy the rest of the canonical appâ€™s code into the web root
COPY webroot/ ${WEB_ROOT}/

# 3) Stage overlay; apply only when building GigHive flavor
COPY overlays/gighive/ /opt/gighive-overlay/
RUN if [ "$APP_FLAVOR" = "gighive" ]; then \
      cp -a /opt/gighive-overlay/. ${WEB_ROOT}/; \
    fi \
 && rm -rf /opt/gighive-overlay


